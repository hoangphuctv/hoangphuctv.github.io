<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Đệ quy trong MIPS &middot; Tran Hoang Phuc</title>

  
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/poole.css">
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://hoangphuctv.github.io/css/highlight/default.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://hoangphuctv.github.io/touch-icon-144-precomposed.png">
  <link href="https://hoangphuctv.github.io/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="Blog lập trình">
  <meta name="keywords" content="lap trinh blog, go, php, linux">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-90002072-5', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body class="theme-base-0b">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1>Tran Hoang Phuc</h1>
      
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://hoangphuctv.github.io/">Home</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      
      
      
      
      
      <a href="https://www.facebook.com/phucth.vn"><i class="fa fa-facebook-square fa-3x"></i></a>
      
      
      <a href="https://hoangphuctv.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>

    

    <p>Copyright &copy; 2019 <a href="https://hoangphuctv.github.io/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Đệ quy trong MIPS</h1>
    <span class="post-date">Jun 5, 2011 &middot; 2 minute read
    

    
    <br/>
    <a class="label" href="https://hoangphuctv.github.io/categories/mips">MIPS</a>
    </span>
    <p>Để thực hiện  được đệ quy trong MIPS, điều quan tâm của chúng ta là các kết quả trung  gian và thanh ghi địa chỉ $ra. MIPS cung cấp cho&nbsp;&nbsp;chúng ta một stack  pointer (thanh ghi $sp). Theo cơ chế stack thì cứ trước mỗi lần gọi thì  ta giảm giá trị của thanh $sp, sau đó Push vào các kết quả trung gian  cần nhớ và thanh ghi $ra. Sau lời gọi đệ quy thì ta lấy lại các kết quả  trung gian xử lí tính toán và phục hồi lại thanh $ra, sau đó jr $ra là  OK!<br />
<a name='more'></a><br />
Nguyên nhân tại sao lại lưu thanh ghi $ra: Khi ta gọi thủ tục jal [ten-thu-tuc],  thì lúc đó thanh ghi $ra tự động cập nhật lại địa chỉ phái sau lệnh  jal, để chương trình sau khi thực hiện xong thủ tục thì chạy về thủ tục  gọi hàm và thực hiện tiếp những lệnh sau nó. Khi đệ quy, tức là gọi lại  thủ tục đó nhiều lần, nếu như ta không lưu lại thanh ghi $ra thì $ra sẽ  được cập nhật mới sau mỗi lần gọi đệ quy. Vì thế nó sẽ không nhớ được  đường về những lần gọi thủ tục trước lần gọi cuối cùng.<br />
Và sau đây là một bài code mẫu tính giai thừa bằng đệ quy:<br />
`.data</p>

<p>st_Nhap: .asciiz &ldquo;Nhap vao so n: &ldquo;<br />
.text<br />
main:</p>

<p>addi $v0 $0, 5<br />
  syscall<br />
  addi $a0, $v0, 0<br />
  jal giaithua<br />
  addi $a0, $v0, 0<br />
  addi $v0 $0, 1<br />
  syscall</p>

<p>addi $v0 $0, 10<br />
  syscall<br />
giaithua: # &lt;=&gt; $v0 = giaithua($a0)</p>

<p>bne $a0, $0 , dequy<br />
  addi $v0, $0, 1<br />
  jr $ra<br />
  dequy:<br />
    addi $sp, $sp, -8<br />
    sw $a0, 0($sp)<br />
    sw $ra, 4($sp)<br />
    addi $a0, $a0, -1<br />
    jal giaithua</p>

<pre><code>lw $a0, 0($sp)  
addi $a1, $v0, 0  
jal Nhan  

lw $ra, 4($sp)  
addi $sp, $sp, 8  
</code></pre>

<p>jr $ra</p>

<p>Nhan:<br />
  addi $sp, $sp, -4<br />
  sw $ra, 0($sp)<br />
  addi $v0, $0, 0<br />
  LapNhan:<br />
    slt $t0, $0, $a1<br />
    beq $t0, $0, KTLapNhan<br />
    add $v0, $v0, $a0<br />
    addi $a1, $a1, -1<br />
    j LapNhan<br />
  KTLapNhan:</p>

<p>lw $ra, 0($sp)<br />
  addi $sp, $sp, 4<br />
  jr $ra<br />
`</p>

  </div>
  

  

</div>




<script src="https://hoangphuctv.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

